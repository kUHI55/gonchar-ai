src/app/components/EinsteinLoader.jsx
"use client";

import { useEffect, useState } from "react";
import EinsteinLoader from "../components/EinsteinLoader";

export default function LessonsPage() {
  const [loading, setLoading] = useState(true);
  const [lesson, setLesson] = useState(null);

  // –ó–∞–≥–ª—É—à–∫–∞: –∏–º–∏—Ç–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∑–∫—É ‚Äú—É—Ä–æ–∫–∞‚Äù
  useEffect(() => {
    const topic = localStorage.getItem("topic") || "–ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è";

    setTimeout(() => {
      setLesson({
        title: topic,
        theory:
          –¢–µ–º–∞: ${topic}\n\n +
          "1) –ö–æ—Ä–æ—Ç–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏.\n" +
          "2) –ü—Ä–∏–º–µ—Ä.\n" +
          "3) –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏.\n\n" +
          "–ß—É—Ç—å –ø–æ–∑–∂–µ —Å—é–¥–∞ –ø–æ–¥–∫–ª—é—á–∏–º GPT, —á—Ç–æ–±—ã –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –ø–æ–¥ —É—á–µ–Ω–∏–∫–∞.",
        tasks: [
          { id: "t1", text: "–†–µ—à–∏: x¬≤ ‚àí 5x + 6 = 0" },
          { id: "t2", text: "–ù–∞–π–¥–∏ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç: x¬≤ + 4x + 5 = 0" },
          { id: "t3", text: "–†–µ—à–∏: 2x¬≤ ‚àí 8x = 0" },
        ],
      });
      setLoading(false);
    }, 1800);
  }, []);

  if (loading) return <EinsteinLoader text="–ì–µ–Ω–µ—Ä–∏—Ä—É—é –ø–ª–∞–Ω –∏ –∑–∞–¥–∞—á–∏..." />;

  return (
    <div style={styles.page}>
      <header style={styles.header}>
        <div>
          <div style={styles.brand}>Gonchar AI</div>
          <h1 style={styles.h1}>{lesson.title}</h1>
        </div>
        <button
          style={styles.btnSecondary}
          onClick={() => (window.location.href = "/")}
        >
          –ù–æ–≤–∞—è —Ç–µ–º–∞
        </button>
      </header>

      <div style={styles.grid}>
        {/* –õ–ï–í–û: –∑–∞–¥–∞—á–∏ */}
        <aside style={styles.left}>
          <div style={styles.panelTitle}>–ó–∞–¥–∞—á–∏</div>
          <div style={styles.list}>
            {lesson.tasks.map((t) => (
              <div key={t.id} style={styles.task}>
                <div style={styles.taskId}>{t.id.toUpperCase()}</div>
                <div>{t.text}</div>
              </div>
            ))}
          </div>
        </aside>

        {/* –¶–ï–ù–¢–†: —Ç–µ–æ—Ä–∏—è */}
        <main style={styles.center}>
          <div style={styles.panelTitle}>–ú–∞—Ç–µ—Ä–∏–∞–ª</div>
          <pre style={styles.theory}>{lesson.theory}</pre>

          <div style={styles.solutionBox}>
            <div style={styles.panelTitle}>–¢–≤–æ—ë —Ä–µ—à–µ–Ω–∏–µ</div>
            <textarea
              style={styles.textarea}
              placeholder="–ù–∞–ø–∏—à–∏ —Ä–µ—à–µ–Ω–∏–µ (–ø–æ–∑–∂–µ –¥–æ–±–∞–≤–∏–º –∑–∞–≥—Ä—É–∑–∫—É —Ñ–æ—Ç–æ)‚Ä¶"
            />
            <button
              style={styles.btnPrimary}
              onClick={() => alert("–î–∞–ª—å—à–µ –ø–æ–¥–∫–ª—é—á–∏–º –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ Wolfram + GPT")}
            >
              –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ
            </button>
          </div>
        </main>

        {/* –ü–†–ê–í–û: —á–∞—Ç */}
        <aside style={styles.right}>
          <div style={styles.panelTitle}>–ß–∞—Ç —Å –≠–π–Ω—à—Ç–µ–π–Ω–æ–º</div>
          <div style={styles.chatBox}>
            <div style={styles.msgBot}>
              –ü—Ä–∏–≤–µ—Ç! –°–ø—Ä–æ—Å–∏, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ –ø–æ —Ç–µ–º–µ üôÇ
            </div>
          </div>
          <div style={styles.chatInputRow}>
            <input style={styles.chatInput} placeholder="–ù–∞–ø–∏—à–∏ –≤–æ–ø—Ä–æ—Å‚Ä¶" />
            <button style={styles.btnSend} onClick={() => alert("–ß–∞—Ç –ø–æ–¥–∫–ª—é—á–∏–º —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º")}>
              ‚Üí
            </button>
          </div>
        </aside>
      </div>
    </div>
  );
}

const styles = {
  page: {
    minHeight: "100vh",
    background: "#0b0f17",
    color: "white",
    padding: 20,
    fontFamily: "system-ui, -apple-system, Segoe UI, Roboto, Arial",
  },
  header: {
    display: "flex",
    justifyContent: "space-between",
    alignItems: "center",
    marginBottom: 16,
  },
  brand: { fontSize: 12, opacity: 0.7 },
  h1: { margin: 0, fontSize: 22 },
  grid: {
    display: "grid",
    gridTemplateColumns: "320px 1fr 340px",
    gap: 14,
    alignItems: "start",
  },
  left: {
    background: "rgba(255,255,255,0.06)",
    border: "1px solid rgba(255,255,255,0.12)",
    borderRadius: 14,
    padding: 14,
    minHeight: 520,
  },
  center: {
    background: "rgba(255,255,255,0.06)",
    border: "1px solid rgba(255,255,255,0.12)",
    borderRadius: 14,
    padding: 14,
    minHeight: 520,
  },
  right: {
    background: "rgba(255,255,255,0.06)",
    border: "1px solid rgba(255,255,255,0.12)",
    borderRadius: 14,
    padding: 14,
    minHeight: 520,
    display: "flex",
    flexDirection: "column",
  },
  panelTitle: { fontSize: 13, opacity: 0.8, marginBottom: 10 },
  list: { display: "grid", gap: 10 },
  task: {
    display: "grid",
    gridTemplateColumns: "52px 1fr",
    gap: 10,
    padding: 10,
    borderRadius: 12,
    background: "rgba(0,0,0,0.35)",
    border: "1px solid rgba(255,255,255,0.10)",
  },
  taskId: { fontWeight: 700, opacity: 0.85 },
  theory: {
    whiteSpace: "pre-wrap",
    background: "rgba(0,0,0,0.35)",
    border: "1px solid rgba(255,255,255,0.10)",
    borderRadius: 12,
    padding: 12,
    margin: 0,
    minHeight: 220,
  },
  solutionBox: { marginTop: 14 },
  textarea: {
    width: "100%",
    minHeight: 120,
    marginTop: 8,
    borderRadius: 12,
    padding: 12,
    background: "rgba(0,0,0,0.35)",
    border: "1px solid rgba(255,255,255,0.12)",
    color: "white",
    outline: "none",
    resize: "vertical",
  },
  chatBox: {
    flex: 1,
    background: "rgba(0,0,0,0.35)",
    border: "1px solid rgba(255,255,255,0.10)",
    borderRadius: 12,
    padding: 12,
    overflowY: "auto",
    minHeight: 260,
  },
  msgBot: {
    padding: 10,
    borderRadius: 12,
    background: "rgba(255,255,255,0.08)",
    border: "1px solid rgba(255,255,255,0.12)",
    width: "fit-content",
    maxWidth: "90%",
  },
  chatInputRow: { display: "flex", gap: 8, marginTop: 10 },
  chatInput: {
    flex: 1,
    borderRadius: 12,
    padding: "10px 12px",
    background: "rgba(0,0,0,0.35)",
    border: "1px solid rgba(255,255,255,0.12)",
    color: "white",
    outline: "none",
  },
  btnPrimary: {
    marginTop: 10,
    width: "100%",
    padding: "10px 12px",
    borderRadius: 12,
    border: "none",
    background: "#3b82f6",
    color: "white",
    fontWeight: 700,
    cursor: "pointer",
  },
  btnSecondary: {
    padding: "10px 12px",
    borderRadius: 12,
    border: "1px solid rgba(255,255,255,0.18)",
    background: "rgba(255,255,255,0.06)",
    color: "white",
    cursor: "pointer",
  },
  btnSend: {
    width: 42,
    borderRadius: 12,
    border: "none",
    background: "#3b82f6",
    color: "white",
    fontWeight: 900,
    cursor: "pointer",
  },
};